
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Cấm 1 người dùng tạo kết nối ra ngoài bằng Iptables trên Linux! - Mr.Hien's Blog</title>
  <meta name="author" content="Hien">

  
  <meta name="description" content="Iptables có 1 module gọi là “owner” (ipt_owner cho kernel &lt;2.6.25 và xt_owner cho kernel >=2.6.25) cho phép người quản trị có thể cấm 1 người &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://mrhien.info/blog/cam-1-nguoi-dung-tao-ket-noi-ra-ngoai-bang-iptables-tren-linux">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Mr.Hien's Blog" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Mr.Hien's Blog</a></h1>
  
    <h2>Do one thing and do it well.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:mrhien.info" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Home</a></li>
  <li><a href="/12a5/">12A5</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/about/">About</a></li>

</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Cấm 1 Người Dùng tạo Kết Nối Ra Ngoài Bằng Iptables Trên Linux!</h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-11-05T16:57:00+07:00" pubdate data-updated="true">Nov 5<span>th</span>, 2010</time>
        
      </p>
    
  </header>


<div class="entry-content"><p><img class="center" src="http://mrhien.info/wp-content/uploads/firewall.png"></p>

<p>Iptables có 1 module gọi là “owner” (ipt_owner cho kernel &lt;2.6.25 và xt_owner cho kernel >=2.6.25) cho phép người quản trị có thể cấm 1 người dụng nhất định trên hệ thống cục bộ  tạo kết nối ra ngoài. Module “owner” chỉ hợp lệ trong chain OUTPUT và POSTROUTING của iptables. Sau đây là cú pháp:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>iptables -A OUTPUT -o ethX -m owner –uid-owner {USERNAME} -j DROP|REJECT</span></code></pre></td></tr></table></div></figure>


<p>Ví dụ: Muốn cấm người dụng có tên là “jenny” có user id là 505 thì rule iptables sẽ như sau:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>iptables -A OUTPUT -m owner –uid-owner jenny -j DROP</span></code></pre></td></tr></table></div></figure>


<p>Hoặc:</p>

<!--more-->


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>iptables -A OUTPUT -m owner –uid-owner 505 -j DROP</span></code></pre></td></tr></table></div></figure>


<p>Tham số: “uid-owner” : thì sử dụng username hoặc userid đều được.
Cuối cùng nhớ lưu rules iptables lại!
(Ví dụ trên được thực hiện trên Centos 5.5)</p>

<p>Chúc bạn thành công !</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Hien</span></span>

      








  


<time datetime="2010-11-05T16:57:00+07:00" pubdate data-updated="true">Nov 5<span>th</span>, 2010</time>
      

<span class="categories">
  
    <a class='category' href='/blog/category/linux/'>Linux</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://mrhien.info/blog/cam-1-nguoi-dung-tao-ket-noi-ra-ngoai-bang-iptables-tren-linux/" data-via="linuxbuzz" data-counturl="http://mrhien.info/blog/cam-1-nguoi-dung-tao-ket-noi-ra-ngoai-bang-iptables-tren-linux/" >Tweet</a>
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/su-dung-google-url-shortener-tu-bash-shell/" title="Previous Post: Sử dụng Google URL Shortener từ bash shell">&laquo; Sử dụng Google URL Shortener từ bash shell</a>
      
      
        <a class="basic-alignment right" href="/blog/fedora-15-se-co-ten-ma-lovelock/" title="next Post: Hệ điều hành Fedora 15 sẽ có tên mã Lovelock">Hệ điều hành Fedora 15 sẽ có tên mã Lovelock &raquo;</a>
      
    </p>
  </footer>
</article>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/thu-thuat-linux-su-dung-macro-trong-vim-phan-2/">Sử dụng Macro trong trình soạn thảo vim / vi (Phần 2)</a>
      </li>
    
      <li class="post">
        <a href="/blog/fedora-17-se-co-ten-ma-beefy-miracle/">Hệ điều hành Fedora 17 sẽ có tên mã “Beefy Miracle”</a>
      </li>
    
      <li class="post">
        <a href="/blog/thu-thuat-linux-su-dung-macro-trong-vim-phan-1/">Sử dụng Macro trong trình soạn thảo vim / vi (Phần 1)</a>
      </li>
    
      <li class="post">
        <a href="/blog/cai-dat-postgresql-9-tren-fedora-15/">Cài đặt PostgreSQL 9 trên Fedora 15</a>
      </li>
    
      <li class="post">
        <a href="/blog/cai-dat-apache-tomcat-7-tren-centos-5/">Cài đặt Apache Tomcat 7 trên Centos 5/RHEL 5</a>
      </li>
    
      <li class="post">
        <a href="/blog/fedora-16-se-co-ten-ma-verne/">Hệ điều hành Fedora 16 sẽ có tên mã “Verne”</a>
      </li>
    
      <li class="post">
        <a href="/blog/thu-thuat-linux-ma-hoa-tap-tin-voi-openssl/">Mã hóa tập tin với OpenSSL</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>Github Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/hien">@hien</a> on Github
  
  <script type="text/javascript">
    $.domReady(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'hien',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>


<section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <li class="loading">Status updating...</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("linuxbuzz", 4, false);
    });
  </script>
  <script src="/javascripts/twitter.js" type="text/javascript"> </script>
  
    <a href="http://twitter.com/linuxbuzz" class="twitter-follow-button" data-show-count="false">Follow @linuxbuzz</a>
  
</section>




<section>
<h1>Website Links</h1>

<a href="http://dosx.net/" rel="friend" title="DosX.net" target="_blank" >DosX.net</a>
<a href="http://hpfc.vn/" rel="contact colleague" title="Diễn Đàn hội cổ động viên bóng đá Hải Phòng" target="">Haiphong-Fc</a>
<a href="http://www.facebook.com/phanquochien" rel="me" title="Mr.Hien on Facebook" target="_blank" >Mr.Hien on Facebook</a>
<a href="http://muagiatot.com/" rel="friend" title="Rao vat, mua ban, can mua, can ban" target="_blank" >Rao vat, mua ban, can mua, can ban</a></li>
<a href="http://testniit.wordpress.com/" rel="neighbor" title="Hieuneo&#8217;s Blog" target="_blank" >TEST NIIT | BLOG NIIT</a>
<a href="http://tncn.tct.vn/" rel="friend colleague" title="Thue Thu Nhap Ca Nhan" target="_blank" >Thue Thu Nhap Ca Nhan</a>
</section>

  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2012 - Hien -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
